<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Higher Number Game</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      color: white;
      text-align: center;
      overflow: hidden;
    }

    /* Background container for crossfade effect */
    #bg-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }

    .bg-image {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      opacity: 0;
      transition: opacity 2s ease-in-out;
    }

    .bg-image.active {
      opacity: 1;
    }

    #score {
      font-size: 5vw; /* responsive text */
      margin: 10px;
    }

    .ball {
      position: absolute;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      cursor: pointer;
      color: white;
      user-select: none;
      animation: fall 6s linear forwards;

      /* responsive sizing */
      width: 15vw;
      height: 15vw;
      max-width: 100px;
      max-height: 100px;
      min-width: 60px;
      min-height: 60px;
      font-size: 6vw;
      max-font-size: 28px;
    }

    @keyframes fall {
      from { top: -120px; }
      to { top: 100vh; }
    }
  </style>
</head>
<body>
  <!-- Background slideshow -->
  <div id="bg-container">
    <div class="bg-image active" id="bg1"></div>
    <div class="bg-image" id="bg2"></div>
  </div>

  <div id="score">Score: 0</div>

  <script>
    /********** Background slideshow **********/
    const images = [
      "https://static.vecteezy.com/system/resources/thumbnails/049/855/347/small_2x/nature-background-high-resolution-wallpaper-for-a-serene-and-stunning-view-photo.jpg",
      "https://wallpaperaccess.com/full/317501.jpg",
      "https://images.unsplash.com/photo-1506748686214-e9df14d4d9d0",
      "https://images.unsplash.com/photo-1470770841072-f978cf4d019e"
    ];

    let current = 0;
    const bg1 = document.getElementById("bg1");
    const bg2 = document.getElementById("bg2");
    let showingBg1 = true;

    bg1.style.backgroundImage = `url(${images[current]})`;

    setInterval(() => {
      current = (current + 1) % images.length;
      if (showingBg1) {
        bg2.style.backgroundImage = `url(${images[current]})`;
        bg2.classList.add("active");
        bg1.classList.remove("active");
      } else {
        bg1.style.backgroundImage = `url(${images[current]})`;
        bg1.classList.add("active");
        bg2.classList.remove("active");
      }
      showingBg1 = !showingBg1;
    }, 20000); // change every 20s

    /********** Falling Ball Game **********/
    let score = 0;
    let roundActive = false;
    let currentBalls = [];

    function updateScore(points) {
      score += points;
      document.getElementById("score").textContent = "Score: " + score;
    }

    function spawnBalls() {
      if (roundActive) return;
      roundActive = true;

      // remove leftover
      currentBalls.forEach(ball => ball.remove());
      currentBalls = [];

      // two unique numbers
      let num1 = Math.floor(Math.random() * 10);
      let num2;
      do {
        num2 = Math.floor(Math.random() * 10);
      } while (num2 === num1);

      const higher = Math.max(num1, num2);
      const lower = Math.min(num1, num2);
      const diff = higher - lower;

      // create 2 balls in left/right halves
      const ball1 = createBall(num1, "left");
      const ball2 = createBall(num2, "right");
      currentBalls.push(ball1, ball2);

      function endRound(choice) {
        if (choice !== null) {
          if (choice === higher) updateScore(diff);
          else updateScore(-diff);
        }
        currentBalls.forEach(ball => ball.remove());
        currentBalls = [];
        roundActive = false;
        setTimeout(spawnBalls, 800);
      }

      // click & touch listeners
      [ball1, ball2].forEach(ball => {
        const handler = () => {
          if (!roundActive) return;
          endRound(parseInt(ball.textContent));
        };
        ball.addEventListener("click", handler);
        ball.addEventListener("touchstart", handler, {passive:true});
      });

      // remove automatically when fall completes
      currentBalls.forEach(ball => {
        ball.addEventListener("animationend", () => {
          if (roundActive) {
            endRound(null); // missed both
          }
        });
      });
    }

    function createBall(value, side) {
      const ball = document.createElement("div");
      ball.className = "ball";
      ball.textContent = value;

      const halfWidth = window.innerWidth / 2 - 120;

      if (side === "left") {
        ball.style.left = Math.random() * halfWidth + "px";
      } else {
        ball.style.left = (window.innerWidth / 2) + Math.random() * halfWidth + "px";
      }

      // random color
      const colors = [
        "#e74c3c", "#3498db", "#2ecc71", "#9b59b6",
        "#f39c12", "#1abc9c", "#e67e22", "#ff69b4"
      ];
      const color = colors[Math.floor(Math.random() * colors.length)];
      ball.style.background = `radial-gradient(circle at 30% 30%, ${color}, #000)`;

      document.body.appendChild(ball);
      return ball;
    }

    // start game
    spawnBalls();

    // responsive resize
    window.addEventListener("resize", () => {
      currentBalls.forEach(ball => ball.remove());
      currentBalls = [];
      roundActive = false;
      spawnBalls();
    });
  </script>
</body>
</html>
